---
title: "module5"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{module5}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(asta)
library(caschrono)
library(dplyr)
library(ggplot2)
library(lubridate)
```

# Analyse de la série

Dans l'onglet paramètres, il faut commencer par choisir une série parmi les suivantes :

## 1 - La série Airpassengers

```{r}
#La Série Airpassengers au format ts
airpass_ts <- AirPassengers
airpass_ts
(eval(airpass_ts))

plot_ts <- function(serie_ts){
  plot(eval(parse(text = "AirPassengers")))
}

plot_ts("airpass_ts")

plot(eval(parse(text = "AirPassengers")))

airpass_dt <- data.frame(
  date=seq(my("01/1949"), by = "month", length.out = 144),
  as.data.frame(airpass_ts)
)

airpass_dt
```



## 2 - Populations

```{r}
data("popfr")
x2 <- popfr
x2
```
```{r}
data("uspop")
x3 <- uspop
head(x3,15)
```

## 3 - Nombre de morts par accident de la route

```{r}
data("m30")
x4 <- m30
x4
```


# Analyse des séries

L'analyse des séries temporelles se fait à l'aide de 3 principaux types de graphique : 
- les chronogrammes
- les lag-plot
- les month-plot

Pour étudier les séries dans la perspectives de les modéliser, il est parfois nécessaire de les transformer en amont, pour mieux visualiser les phénomènes qui nous intéressent. 

## Transformations des séries

```{r}
log.x1 <- log(x1)
log.x1
```


## Chronogrammes

### Graphique de la série air

```{r}
ggplot(airpass_dt, aes(x = date, y=x)) + geom_line()

```
```{r}


```



## Lag plot

### Pour Airpassengers

```{r}
lag.plot(rev(x1),12,layout = c(4,3),do.lines = FALSE,diag.col = "red")

```

### Pour le nombre d'accidents de la route

```{r}
lag.plot(rev(x4),12,layout = c(4,3),do.lines = FALSE,diag.col = "red")
```

## Month Plot

### Pour Airpass

```{r}
monthplot(x1,cex.main=1)
```

### Pour le nombre d'accidents de la route

```{r}
monthplot(x4,cex.main=1)
```



# Désaisonnalisation

```{r}
plot(decompose(x1,type = "multiplicative"))
```


# Prévisionsftgg

## Lissage exponentiel


```{r}
library(forecast)
library(expsmooth)
library(caschrono)
fmsales

ets0 <- ets(fmsales,model="ANN",alpha = 0.1)
plot(fmsales)
summary(ets0)
aaa <- predict(ets0,4)
aaa
plot(aaa)
HoltWinters(ets0,alpha = 0.1,seasonal = "additive")
```
