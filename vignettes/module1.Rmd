---
title: "module1"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{module1}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup,warning=FALSE,echo=FALSE,include=FALSE}
library(asta)
library(questionr)
library(dplyr)
library(kableExtra)
library(DT)
library(ggplot2)
library(plotly)
library(rAmCharts)
library(purrr)
```

# Les données

# Statistique descriptive univariée

## Sur une qualitative

### Les graphiques

#### Les graphiques avec rAmCharts


Il n'est pas possible d'introduire un rAmCharts dans un shiny.
L'erreur suivante apparaît : impossible de trouver la fonction "controlShinyPlot"...

```{r}
#Préparation de la fonction pour un amPie
a <- freq(grandile$LIB_PCS,valid = FALSE) 
b <-rownames(a)
c <- cbind(a,b) %>% as.data.frame() %>% 
  rename(label = b,value = n) %>% 
  select(label,value)

rAmCharts::amPie(c,show_values = TRUE)

rambarplot_quali(grandile,"LIB_PCS")




```

Les graphiques avec GGPLOT2

```{r}
#Exemple
graphggplotly_diagbarre(grandile,var = "PCS")
```


### Les tris à plat

```{r}
#Exemple
a <- tri_plat(grandile,"LIB_PCS") 

#Fonction pour mettre en forme le tableau
a %>% DT::datatable(class = "cell-border hover order-colum")


```

## Sur une quantitative

## Graphique

```{r}
graphggplotly_histo(grandile,"REV_DISPONIBLE",10)


```

## Indicateurs statistiques

```{r}
moy <- mean(grandile$AGE)
median <- median(grandile$AGE)
q1 <- quantile(grandile$AGE,0.25)
q3 <- quantile(grandile$AGE,0.75)

indic_centrale_age <- data.frame(moy,median,q1,q3)
indic_centrale_age %>% map_chr(format_box)

format_box(mean(grandile$PATRIMOINE))

moy <- mean(grandile$AGE)
format_box(moy)

```



# Statistique descriptive bivariée

## Entre deux variables quantitatives

### Graphique

```{r}
graphggplotly_nuage(grandile,"REV_DISPONIBLE","PATRIMOINE")


```

### Indicateur

```{r}

a <- cor(grandile[,"REV_DISPONIBLE"],grandile[,"PATRIMOINE"])

format_box(a)
```


## Entre deux variables qualitatives

## Entre une variable quantitative et une variable qualitative

### Graphique

```{r}
graphggplotly_qualiquanti(grandile,"PCS","REV_DISPONIBLE")
```

```{r}
tab <- tab_moyenne(grandile,"PCS","AGE")

#Fonction pour calculer la variation inter-groupe sur la quanti
inter <- sum(tab$Contrib_inter)
format_box(inter)

#Fonction pour calculer la variation intra-groupe sur la quanti
intra <- sum(tab$Contrib_intra)
format_box(intra)

#Variance sur la quanti
var <- var(grandile[,"AGE"])
format_box(var)

#Rapport de corrélation
eta2 <- (inter/var)*100
paste(format_box(eta2),"%")

```


# Statistique inférentielle


